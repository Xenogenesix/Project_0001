from pymongo import MongoClient

client = MongoClient("mongodb+srv://BubblyCat:Bobyr777@cluster0.3murmbb.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0")
db = client["books_db"]
collection = db["books"]

print("\nüìö –í—Å—ñ –∫–Ω–∏–≥–∏:")
for book in collection.find():
    print(f"  - {book.get('–Ω–∞–∑–≤–∞', '–ë–µ–∑ –Ω–∞–∑–≤–∏')} ({book.get('–∫—ñ–ª—å–∫—ñ—Å—Ç—å_—Å—Ç–æ—Ä—ñ–Ω–æ–∫')} —Å—Ç–æ—Ä—ñ–Ω–æ–∫)")

print("\nüîç –ö–Ω–∏–≥–∞ –∑ –Ω–∞–∑–≤–æ—é '–ì—Ä–∞ –ø—Ä–µ—Å—Ç–æ–ª—ñ–≤':")
book = collection.find_one({"–Ω–∞–∑–≤–∞": "–ì—Ä–∞ –ø—Ä–µ—Å—Ç–æ–ª—ñ–≤"})
print(book if book else "  ‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ")

print("\nüìò –ö–Ω–∏–≥–∏ –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Å—Ç–æ—Ä—ñ–Ω–æ–∫ > 200:")
for book in collection.find({"–∫—ñ–ª—å–∫—ñ—Å—Ç—å_—Å—Ç–æ—Ä—ñ–Ω–æ–∫": {"$gt": 200}}):
    print(f"  - {book['–Ω–∞–∑–≤–∞']} ({book['–∫—ñ–ª—å–∫—ñ—Å—Ç—å_—Å—Ç–æ—Ä—ñ–Ω–æ–∫']} —Å—Ç–æ—Ä—ñ–Ω–æ–∫)")

print("\n‚úèÔ∏è –ó–º—ñ–Ω—é—î–º–æ –≤–∞—Ä—Ç—ñ—Å—Ç—å –∫–Ω–∏–≥–∏ '–ì—Ä–∞ –ø—Ä–µ—Å—Ç–æ–ª—ñ–≤' –Ω–∞ 450 –≥—Ä–Ω...")
collection.update_one(
    {"–Ω–∞–∑–≤–∞": "–ì—Ä–∞ –ø—Ä–µ—Å—Ç–æ–ª—ñ–≤"},
    {"$set": {"–≤–∞—Ä—Ç—ñ—Å—Ç—å": 450}}
)
print("‚úÖ –í–∞—Ä—Ç—ñ—Å—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–æ.\n")

print("‚≠ê –î–æ–¥–∞—î–º–æ –ø–æ–ª–µ 'favorite': True –¥–ª—è –∫–Ω–∏–≥ 10 –∫–ª–∞—Å—É...")
collection.update_many(
    {"–∫–ª–∞—Å": 10},
    {"$set": {"favorite": True}}
)
print("‚úÖ –û–Ω–æ–≤–ª–µ–Ω–æ –≤—Å—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ –∫–Ω–∏–≥–∏.\n")

print("üóë –í–∏–¥–∞–ª—è—î–º–æ –æ–¥–Ω—É –∫–Ω–∏–≥—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, '–•—ñ–º—ñ—è')...")
collection.delete_one({"–Ω–∞–∑–≤–∞": "–•—ñ–º—ñ—è"})
print("‚úÖ –í–∏–¥–∞–ª–µ–Ω–æ –∫–Ω–∏–≥—É '–•—ñ–º—ñ—è'.\n")

print("üßπ –í–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –∫–Ω–∏–≥–∏ –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Å—Ç–æ—Ä—ñ–Ω–æ–∫ –º–µ–Ω—à–µ 100...")
deleted = collection.delete_many({"–∫—ñ–ª—å–∫—ñ—Å—Ç—å_—Å—Ç–æ—Ä—ñ–Ω–æ–∫": {"$lt": 100}})
print(f"‚úÖ –í–∏–¥–∞–ª–µ–Ω–æ {deleted.deleted_count} –∫–Ω–∏–≥.\n")

print("–û–Ω–æ–≤–ª–µ–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∫–Ω–∏–≥:")
for book in collection.find():
    print(f"  - {book.get('–Ω–∞–∑–≤–∞', '–ë–µ–∑ –Ω–∞–∑–≤–∏')} ({book.get('–∫—ñ–ª—å–∫—ñ—Å—Ç—å_—Å—Ç–æ—Ä—ñ–Ω–æ–∫')} —Å—Ç–æ—Ä—ñ–Ω–æ–∫)")
print("@BubblyCat")